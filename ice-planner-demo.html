<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ice Planner - Hockey Team Cost Calculator</title>
    <meta name="description" content="Calculate hockey team costs including ice time, coaching, jerseys, and fees">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèí</text></svg>">
    
    <!-- DDD Tokens and Base Styles -->
    <style>
        * {
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #06b6d4 100%);
            min-height: 100vh;
        }

        /* Loading skeleton */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: white;
            font-size: 1.2rem;
        }

        .loading::after {
            content: 'üèí';
            animation: bounce 1s ease-in-out infinite alternate;
            margin-left: 0.5rem;
            font-size: 2rem;
        }

        @keyframes bounce {
            from {
                transform: translateY(0);
            }
            to {
                transform: translateY(-10px);
            }
        }

        /* Hide loading once components are loaded */
        ice-planner:defined ~ .loading {
            display: none;
        }

        /* Error styles */
        .error {
            max-width: 600px;
            margin: 2rem auto;
            padding: 2rem;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            color: #dc2626;
            text-align: center;
        }

        /* Demo styles */
        .demo-header {
            text-align: center;
            padding: 2rem 1rem;
            color: white;
            background: rgba(0, 0, 0, 0.1);
        }

        .demo-header h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .demo-header p {
            margin: 0.5rem 0 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Footer */
        .demo-footer {
            text-align: center;
            padding: 2rem 1rem;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .demo-footer a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
        }

        .demo-footer a:hover {
            text-decoration: underline;
        }

        /* PWA support hint */
        .install-hint {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 6px;
            font-size: 0.85rem;
            max-width: 250px;
            display: none;
            z-index: 1000;
        }

        .install-hint.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .demo-header h1 {
                font-size: 2rem;
            }

            .demo-header p {
                font-size: 1rem;
            }

            body {
                background: linear-gradient(180deg, #1e3a8a 0%, #3b82f6 50%, #06b6d4 100%);
            }
        }
    </style>
</head>
<body>
    <div class="demo-header">
        <h1>üèí Ice Planner</h1>
        <p>Hockey Team Cost Calculator</p>
    </div>

    <!-- Main Application -->
    <ice-planner
        team-name="Team Hawks"
        ice-hours="50"
        ice-cost-per-hour="300"
        coach-cost="3000"
        jersey-cost="88"
        number-of-players="12"
        fee-percentage="2"
        fixed-fee="0.99">
    </ice-planner>

    <!-- Loading state -->
    <div class="loading">
        Loading Ice Planner...
    </div>

    <!-- Error fallback -->
    <div class="error" style="display: none;" id="error-message">
        <h3>‚ö†Ô∏è Error Loading Component</h3>
        <p>There was a problem loading the Ice Planner component. Please check the browser console for details.</p>
        <details style="margin-top: 1rem; text-align: left;">
            <summary>Technical Details</summary>
            <pre id="error-details"></pre>
        </details>
    </div>

    <!-- Footer -->
    <div class="demo-footer">
        <p>Built with <a href="https://haxtheweb.org/" target="_blank" rel="noopener">HAX</a> and the <a href="https://github.com/haxtheweb/d-d-d" target="_blank" rel="noopener">DDD Design System</a></p>
    </div>

    <!-- PWA Install Hint -->
    <div class="install-hint" id="install-hint">
        üí° Add to home screen for quick access!
        <button onclick="hideInstallHint()" style="background: none; border: none; color: white; cursor: pointer; float: right;">√ó</button>
    </div>

    <!-- Component Scripts -->
    <script type="module">
        try {
            // Import the main component
            await import('./ice-planner.js');
            
            // Hide loading spinner
            document.querySelector('.loading').style.display = 'none';
            
            // Show install hint for PWA-capable browsers
            if ('serviceWorker' in navigator) {
                setTimeout(() => {
                    const hint = document.getElementById('install-hint');
                    hint.classList.add('show');
                    
                    // Auto-hide after 5 seconds
                    setTimeout(() => {
                        hint.classList.remove('show');
                    }, 5000);
                }, 2000);
            }
            
        } catch (error) {
            console.error('Failed to load ice-planner component:', error);
            
            // Show error message
            document.querySelector('.loading').style.display = 'none';
            const errorEl = document.getElementById('error-message');
            errorEl.style.display = 'block';
            document.getElementById('error-details').textContent = error.stack || error.message;
        }
    </script>

    <!-- PWA Functions -->
    <script>
        function hideInstallHint() {
            document.getElementById('install-hint').classList.remove('show');
        }

        // Handle PWA install prompt
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show custom install button
            const hint = document.getElementById('install-hint');
            hint.innerHTML = `
                <button onclick="installPWA()" style="background: #3b82f6; border: none; color: white; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">
                    üì± Install App
                </button>
                <button onclick="hideInstallHint()" style="background: none; border: none; color: white; cursor: pointer; float: right;">√ó</button>
            `;
            hint.classList.add('show');
        });
        
        async function installPWA() {
            if (!deferredPrompt) return;
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            if (outcome === 'accepted') {
                console.log('User accepted PWA install');
            }
            
            deferredPrompt = null;
            hideInstallHint();
        }

        // Analytics and performance monitoring
        window.addEventListener('load', () => {
            // Log performance metrics
            if ('performance' in window) {
                const perfData = performance.getEntriesByType('navigation')[0];
                console.log('Page load time:', perfData.loadEventEnd - perfData.loadEventStart, 'ms');
            }
        });

        // Handle offline state
        window.addEventListener('online', () => {
            console.log('Back online');
        });

        window.addEventListener('offline', () => {
            console.log('Gone offline');
        });
    </script>

    <!-- Accessibility improvements -->
    <script>
        // Skip to main content functionality
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Tab' && !e.shiftKey && document.activeElement === document.body) {
                const icePlanner = document.querySelector('ice-planner');
                if (icePlanner) {
                    icePlanner.focus();
                    e.preventDefault();
                }
            }
        });

        // High contrast mode detection
        if (window.matchMedia('(prefers-contrast: high)').matches) {
            document.body.classList.add('high-contrast');
        }

        // Reduced motion preference
        if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
            document.body.classList.add('reduced-motion');
        }
    </script>

    <!-- SEO and Social Media Meta Tags -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Ice Planner",
        "description": "Hockey team cost calculator for ice time, coaching, jerseys, and fees",
        "url": window.location.origin,
        "applicationCategory": "SportApplication",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "creator": {
            "@type": "Person",
            "name": "kadenmangin"
        }
    }
    </script>
</body>
</html>